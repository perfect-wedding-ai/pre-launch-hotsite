document.addEventListener("DOMContentLoaded",(()=>{const e={mobile:480,tablet:768,desktop:1200},t="50px 0px",o=(()=>{const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")})();console.log("Suporte a WebP: "+(o?"Sim":"Não"));const n=()=>{const t=window.innerWidth;return t<=e.mobile?"mobile":t<=e.tablet?"tablet":"desktop"},s=(e,t)=>{const n=e.split("/"),s=n.pop(),[a,r]=s.split(".");if(a.includes("-mobile")||a.includes("-tablet")||a.includes("-desktop"))return e;const i=`${a}-${t}.${o?"webp":r}`;return[...n,i].join("/")},a=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&((e=>{const t=e.dataset.src;if(!t)return;const o=n(),a=s(t,o),r=new Image;r.onload=()=>{e.src=a,e.classList.add("loaded")},r.onerror=()=>{console.warn(`Imagem responsiva não encontrada: ${a}, usando original.`),e.src=t,e.classList.add("loaded")},r.src=a})(e.target),a.unobserve(e.target))}))}),{rootMargin:t});let r;document.querySelectorAll("img[data-src]").forEach((e=>{a.observe(e)})),window.addEventListener("resize",(()=>{clearTimeout(r),r=setTimeout((()=>{document.querySelectorAll("img.loaded").forEach((e=>{if(e.dataset.src){const t=n(),o=s(e.dataset.src,t);e.src!==o&&(e.src=o)}}))}),250)})),console.log("Lazy loading e imagens responsivas inicializados.")}));